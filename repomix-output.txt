This file is a merged representation of the entire codebase, combining all repository files into a single document.
Generated by Repomix on: 2025-01-16T03:28:45.157Z

================================================================
File Summary
================================================================

Purpose:
--------
This file contains a packed representation of the entire repository's contents.
It is designed to be easily consumable by AI systems for analysis, code review,
or other automated processes.

File Format:
------------
The content is organized as follows:
1. This summary section
2. Repository information
3. Repository structure
4. Multiple file entries, each consisting of:
  a. A separator line (================)
  b. The file path (File: path/to/file)
  c. Another separator line
  d. The full contents of the file
  e. A blank line

Usage Guidelines:
-----------------
- This file should be treated as read-only. Any changes should be made to the
  original repository files, not this packed version.
- When processing this file, use the file path to distinguish
  between different files in the repository.
- Be aware that this file may contain sensitive information. Handle it with
  the same level of security as you would the original repository.

Notes:
------
- Some files may have been excluded based on .gitignore rules and Repomix's
  configuration.
- Binary files are not included in this packed representation. Please refer to
  the Repository Structure section for a complete list of file paths, including
  binary files.

Additional Info:
----------------

For more information about Repomix, visit: https://github.com/yamadashy/repomix

================================================================
Repository Structure
================================================================
.gitignore
app/config.py
app/gemini.py
app/google_sheets.py
app/gui.py
app/main.py
LICENSE
README.md
requirements.txt

================================================================
Repository Files
================================================================

================
File: .gitignore
================
.env
key.env
test.jpg
test.py
tempCodeRunnerFile.py
data.json
test
__pycache__
.repomixignore
repomix.config.json

================
File: app/config.py
================
import os
from dotenv import load_dotenv

# Load environment variables
load_dotenv('key.env')

SHEET_ID = os.getenv('SHEET_ID')
GEMINI_API_KEY = os.getenv('GEMINI_API_KEY')

================
File: app/gemini.py
================
import google.generativeai as genai
from google.ai.generativelanguage_v1beta.types import content

def configure_gemini(api_key, mode="chat"):
    genai.configure(api_key=api_key)

    if mode == "chat":
        generation_config = {
            "temperature": 1,
            "top_p": 0.95,
            "top_k": 40,
            "max_output_tokens": 8192,
            "response_schema": content.Schema(
                type=content.Type.OBJECT,
                required=["note", "category", "amount"],
                properties={
                    "note": content.Schema(type=content.Type.STRING),
                    "category": content.Schema(type=content.Type.STRING),
                    "amount": content.Schema(type=content.Type.NUMBER),
                },
            ),
            "response_mime_type": "application/json",
        }
    elif mode == "analysis":
        generation_config = {
            "temperature": 0.3,        # Giáº£m sÃ¡ng táº¡o, tÄƒng tÃ­nh logic
            "top_p": 0.85,
            "top_k": 50,
            "max_output_tokens": 8192,
            "response_mime_type": "text/plain",  # Tráº£ vá» vÄƒn báº£n thÆ°á»ng
        }

    model = genai.GenerativeModel(
        model_name="gemini-1.5-flash",
        generation_config=generation_config,
    )

    return model

================
File: app/google_sheets.py
================
import requests
import csv
from io import StringIO
from tkinter import messagebox

def send_to_google_sheets(data, sheet_id):
    url = 'https://script.google.com/macros/s/AKfycbwrnLikw6-OvK4mj7VCPqukDuiPK3ucZPQNtYYDkm2XoaSeo0g9FLhJaco3Ajuy_qn2Gg/exec'
    data['SHEET_ID'] = sheet_id
    try:
        response = requests.post(url, json=data)
        if response.status_code == 200:
            messagebox.showinfo("Success", "Dá»¯ liá»‡u Ä‘Ã£ gá»­i thÃ nh cÃ´ng!")
        else:
            messagebox.showerror("Error", f"Lá»—i gá»­i dá»¯ liá»‡u: {response.text}")
    except requests.RequestException as e:
        messagebox.showerror("Káº¿t ná»‘i lá»—i", str(e))

def get_sheet_data(sheet_id, gid=0):
    url = f'https://docs.google.com/spreadsheets/d/{sheet_id}/export?format=csv&gid={gid}'
    try:
        response = requests.get(url)
        if response.status_code == 200:
            f = StringIO(response.text)
            reader = csv.DictReader(f)
            data = list(reader)
            return data
        else:
            messagebox.showerror("Lá»—i", f"Lá»—i láº¥y dá»¯ liá»‡u: {response.status_code}")
            return None
    except requests.RequestException as e:
        messagebox.showerror("Káº¿t ná»‘i lá»—i", str(e))
        return None

================
File: app/gui.py
================
import customtkinter as ctk
from tkinter import filedialog

def setup_gui(process_message, upload_image, analyze_data):
    ctk.set_appearance_mode("Light")  # Light / Dark / System
    ctk.set_default_color_theme("blue")  # green, dark-blue, blue

    root = ctk.CTk()
    root.title("ğŸ’¸ Expense Tracker with Gemini AI")
    root.geometry("900x700")  # ğŸ“ Má»Ÿ rá»™ng chiá»u ngang

    # Header
    header = ctk.CTkLabel(root, text="Expense Tracker ğŸ’°", font=("Helvetica", 26, "bold"))
    header.pack(pady=20)

    # Khu vá»±c hiá»ƒn thá»‹ chat (Má»Ÿ rá»™ng ngang)
    display_area = ctk.CTkTextbox(root, width=850, height=450, font=("Helvetica", 12))
    display_area.pack(pady=10)
    display_area.configure(state='disabled')

    # Khung nháº­p liá»‡u
    entry_frame = ctk.CTkFrame(root)
    entry_frame.pack(pady=10)

    entry = ctk.CTkEntry(entry_frame, width=600, font=("Helvetica", 12))
    entry.pack(side="left", padx=10, pady=10)

    send_button = ctk.CTkButton(entry_frame, text="ğŸ“¨ Gá»­i", width=80, command=process_message)
    send_button.pack(side="left", padx=5)

    upload_button = ctk.CTkButton(root, text="ğŸ“· Táº£i áº¢nh", width=150, command=upload_image)
    upload_button.pack(pady=5)

    analyze_button = ctk.CTkButton(root, text="ğŸ“Š PhÃ¢n TÃ­ch Dá»¯ Liá»‡u", width=150, command=analyze_data)
    analyze_button.pack(pady=5)

    spinner_label = ctk.CTkLabel(root, text="", font=("Helvetica", 10))
    spinner_label.pack(pady=5)

    # Nháº¥n Enter Ä‘á»ƒ gá»­i
    def enter_pressed(event):
        process_message()

    entry.bind("<Return>", enter_pressed)

    return root, display_area, entry, spinner_label

================
File: app/main.py
================
import json
import threading
from config import SHEET_ID, GEMINI_API_KEY
from gemini import configure_gemini
from google_sheets import get_sheet_data, send_to_google_sheets
from gui import setup_gui

# Cáº¥u hÃ¬nh Gemini máº·c Ä‘á»‹nh
model = configure_gemini(GEMINI_API_KEY, mode="chat")
chat_session = model.start_chat(history=[])

def show_spinner(message="ğŸ”„ Äang xá»­ lÃ½..."):
    spinner_label.configure(text=message)
    spinner_label.update()

def hide_spinner():
    spinner_label.configure(text="")
    spinner_label.update()

def send_bot_message(message):
    display_area.configure(state='normal')
    display_area.insert("end", f"ğŸ¤– Bot: {message}\n\n")
    display_area.configure(state='disabled')

def process_message():
    user_msg = entry.get().strip()
    if not user_msg:
        send_bot_message("âš ï¸ Báº¡n chÆ°a nháº­p ná»™i dung.")
        return

    display_area.configure(state='normal')
    display_area.insert("end", f"ğŸ§‘â€ğŸ’» Báº¡n: {user_msg}\n\n")
    display_area.configure(state='disabled')
    entry.delete(0, "end")

    threading.Thread(target=bot_response, args=(user_msg,)).start()

def bot_response(user_msg):
    show_spinner("ğŸ¤– Äang tráº£ lá»i...")
    response = chat_session.send_message(user_msg)
    try:
        data = json.loads(response.text.strip("`"))
        hide_spinner()
        send_bot_message(f"{data}")
        send_to_google_sheets(data, SHEET_ID)
        send_bot_message("âœ… Dá»¯ liá»‡u Ä‘Ã£ Ä‘Æ°á»£c lÆ°u vÃ o Google Sheets.")
    except json.JSONDecodeError:
        hide_spinner()
        send_bot_message("âŒ Bot khÃ´ng hiá»ƒu yÃªu cáº§u cá»§a báº¡n. Vui lÃ²ng thá»­ láº¡i.")

def analyze_data():
    show_spinner("ğŸ“Š Äang phÃ¢n tÃ­ch dá»¯ liá»‡u...")
    threading.Thread(target=analyze_data_thread).start()

def analyze_data_thread():
    data = get_sheet_data(SHEET_ID)
    if data:
        response = chat_session.send_message(f"PhÃ¢n tÃ­ch dá»¯ liá»‡u sau:\n{json.dumps(data)}")
        hide_spinner()
        send_bot_message(f"ğŸ“Š Káº¿t quáº£ phÃ¢n tÃ­ch:\n{response.text}")
    else:
        hide_spinner()
        send_bot_message("âŒ KhÃ´ng láº¥y Ä‘Æ°á»£c dá»¯ liá»‡u tá»« Google Sheets.")

# Khá»Ÿi Ä‘á»™ng giao diá»‡n
root, display_area, entry, spinner_label = setup_gui(process_message, None, analyze_data)
root.mainloop()

================
File: LICENSE
================
MIT License

Copyright (c) 2025 NgÃ´ Táº¥n TÃ i

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

================
File: README.md
================
```markdown
---

# ğŸ“Š Expense Tracker with Gemini

### á»¨ng dá»¥ng ghi chÃ©p vÃ  phÃ¢n tÃ­ch chi tiÃªu cÃ¡ nhÃ¢n thÃ´ng minh tÃ­ch há»£p **Gemini AI** vÃ  **Google Sheets**.

---

## ğŸŒŸ TÃ­nh NÄƒng

âœ… **Ghi chÃ©p chi tiÃªu nhanh chÃ³ng** báº±ng vÄƒn báº£n hoáº·c hÃ¬nh áº£nh.  
âœ… **PhÃ¢n loáº¡i tá»± Ä‘á»™ng** cÃ¡c khoáº£n chi tiÃªu (Äƒn uá»‘ng, xÄƒng xe, mua sáº¯m, v.v.).  
âœ… **LÆ°u trá»¯ dá»¯ liá»‡u an toÃ n** trÃªn **Google Sheets**.  
âœ… **PhÃ¢n tÃ­ch dá»¯ liá»‡u chi tiÃªu chuyÃªn sÃ¢u** vá»›i **Gemini AI**.  
âœ… **Giao diá»‡n trá»±c quan** vá»›i **Tkinter**, há»— trá»£ **nháº¥n Enter Ä‘á»ƒ gá»­i** vÃ  **hiá»ƒn thá»‹ loading** khi xá»­ lÃ½.  

---

## ğŸ›  CÃ´ng Nghá»‡ Sá»­ Dá»¥ng

- **Python 3.x** ğŸ  
- **Tkinter** â€“ Táº¡o giao diá»‡n ngÆ°á»i dÃ¹ng.  
- **Google Generative AI (Gemini API)** â€“ Xá»­ lÃ½ vÃ  phÃ¢n tÃ­ch dá»¯ liá»‡u.  
- **Google Sheets API** â€“ LÆ°u trá»¯ vÃ  truy xuáº¥t dá»¯ liá»‡u.  
- **Requests** â€“ Giao tiáº¿p vá»›i API.  
- **Python-dotenv** â€“ Quáº£n lÃ½ biáº¿n mÃ´i trÆ°á»ng.  

---

## ğŸš€ HÆ°á»›ng Dáº«n CÃ i Äáº·t

### 1ï¸âƒ£ Clone Project

```bash
git clone https://github.com/newnol/gemini-to-sheet.git
cd gemini-to-sheet
```

### 2ï¸âƒ£ Táº¡o MÃ´i TrÆ°á»ng áº¢o

```bash
python -m venv venv
source venv/bin/activate  # Mac/Linux
venv\Scripts\activate     # Windows
```

### 3ï¸âƒ£ CÃ i Äáº·t ThÆ° Viá»‡n

```bash
pip install -r requirements.txt
```

### 4ï¸âƒ£ Thiáº¿t Láº­p Biáº¿n MÃ´i TrÆ°á»ng

Táº¡o file `.env`:

```env
GEMINI_API_KEY=your_gemini_api_key
SHEET_ID=your_google_sheet_id
```

### 5ï¸âƒ£ Cháº¡y á»¨ng Dá»¥ng

```bash
python app/main.py
```

---

## ğŸ® CÃ¡ch Sá»­ Dá»¥ng

1. **Nháº­p ná»™i dung chi tiÃªu** vÃ o Ã´ vÄƒn báº£n.  
   _VÃ­ dá»¥:_ `Nay Äƒn sÃ¡ng 25k`  
2. **Nháº¥n "ğŸ“¨ Gá»­i"** hoáº·c **nháº¥n Enter** Ä‘á»ƒ gá»­i.  
3. **Nháº¥n "ğŸ“· Táº£i áº¢nh"** Ä‘á»ƒ táº£i áº£nh hÃ³a Ä‘Æ¡n hoáº·c áº£nh liÃªn quan.  
4. **Nháº¥n "ğŸ“Š PhÃ¢n TÃ­ch Dá»¯ Liá»‡u"** Ä‘á»ƒ Gemini phÃ¢n tÃ­ch toÃ n bá»™ chi tiÃªu.  
5. Dá»¯ liá»‡u sáº½ **phÃ¢n loáº¡i vÃ  lÆ°u vÃ o Google Sheets**.

---

## ğŸ“‚ Cáº¥u TrÃºc Dá»± Ãn

```
expense_tracker/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ config.py            # Quáº£n lÃ½ biáº¿n mÃ´i trÆ°á»ng
â”‚   â”œâ”€â”€ gemini.py            # TÃ­ch há»£p API Gemini (phÃ¢n tÃ­ch & ghi chÃ©p)
â”‚   â”œâ”€â”€ google_sheets.py     # Gá»­i & láº¥y dá»¯ liá»‡u tá»« Google Sheets
â”‚   â”œâ”€â”€ gui.py               # Giao diá»‡n Tkinter
â”‚   â””â”€â”€ main.py              # Äiá»ƒm khá»Ÿi Ä‘á»™ng á»©ng dá»¥ng
â”‚
â”œâ”€â”€ tests/                   # ThÆ° má»¥c kiá»ƒm thá»­
â”‚   â”œâ”€â”€ test_gemini.py
â”‚   â””â”€â”€ test_google_sheets.py
â”‚
â”œâ”€â”€ .env                     # Biáº¿n mÃ´i trÆ°á»ng (KHÃ”NG commit)
â”œâ”€â”€ .gitignore               # File/thÆ° má»¥c khÃ´ng Ä‘áº©y lÃªn Git
â”œâ”€â”€ README.md                # File mÃ´ táº£ dá»± Ã¡n
â””â”€â”€ requirements.txt         # Danh sÃ¡ch thÆ° viá»‡n cáº§n cÃ i
```

---

## ğŸ“Š VÃ­ Dá»¥ PhÃ¢n TÃ­ch Dá»¯ Liá»‡u

**Nháº­p:**  
```
Nay Äƒn sÃ¡ng 25k
```

**Bot tráº£ lá»i:**  
```json
{
  "note": "Äƒn sÃ¡ng",
  "category": "breakfast",
  "amount": 25000
}
```

**PhÃ¢n tÃ­ch dá»¯ liá»‡u:**  
```
ğŸ“Š Tá»•ng chi tiÃªu thÃ¡ng nÃ y táº­p trung vÃ o Äƒn uá»‘ng (60%), di chuyá»ƒn (25%), vÃ  mua sáº¯m (15%).
ğŸ‘‰ Äá» xuáº¥t: Giáº£m chi tiÃªu Äƒn uá»‘ng Ä‘á»ƒ tiáº¿t kiá»‡m hÆ¡n.
```

---

## â“ CÃ¢u Há»i ThÆ°á»ng Gáº·p

### 1. **LÃ m sao Ä‘á»ƒ láº¥y API Key cá»§a Gemini?**  
- ÄÄƒng kÃ½ táº¡i [Google Cloud Console](https://console.cloud.google.com/).  
- Táº¡o API Key vÃ  dÃ¡n vÃ o file `.env`.

### 2. **Dá»¯ liá»‡u lÆ°u á»Ÿ Ä‘Ã¢u?**  
- Dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»±c tiáº¿p lÃªn **Google Sheets** theo `SHEET_ID`.

### 3. **PhÃ¢n tÃ­ch dá»¯ liá»‡u nhÆ° tháº¿ nÃ o?**  
- Nháº¥n **ğŸ“Š PhÃ¢n TÃ­ch Dá»¯ Liá»‡u** Ä‘á»ƒ láº¥y dá»¯ liá»‡u tá»« Google Sheets vÃ  gá»­i cho Gemini AI phÃ¢n tÃ­ch.

### 4. **á»¨ng dá»¥ng cÃ³ há»— trá»£ Ä‘a ngÃ´n ngá»¯ khÃ´ng?**  
- Hiá»‡n táº¡i á»©ng dá»¥ng há»— trá»£ **Tiáº¿ng Viá»‡t**. Sáº½ má»Ÿ rá»™ng thÃªm cÃ¡c ngÃ´n ngá»¯ khÃ¡c trong tÆ°Æ¡ng lai.

---

## ğŸ“ˆ Káº¿ Hoáº¡ch PhÃ¡t Triá»ƒn

- [x] **PhÃ¢n loáº¡i chi tiÃªu tá»± Ä‘á»™ng**.  
- [x] **PhÃ¢n tÃ­ch dá»¯ liá»‡u chi tiÃªu vá»›i Gemini AI**.  
- [ ] **BÃ¡o cÃ¡o thá»‘ng kÃª chi tiÃªu theo tuáº§n/thÃ¡ng**.  
- [ ] **PhiÃªn báº£n di Ä‘á»™ng (Android/iOS)**.  

---

## ğŸ¤ ÄÃ³ng GÃ³p

1. Fork repository.  
2. Táº¡o nhÃ¡nh má»›i: `git checkout -b feature-name`.  
3. Commit thay Ä‘á»•i: `git commit -m "Add feature"`.  
4. Push nhÃ¡nh: `git push origin feature-name`.  
5. Táº¡o **Pull Request**.

---

## ğŸ’¼ TÃ¡c Giáº£

- **ğŸ‘¤ TÃªn:** [Your Name]  
- **ğŸŒ Website:** [newnol.io.com](https://newnol.io.vn)  
- **ğŸ“§ Email:** tantai@newnol.io.vn  

---

## ğŸ“œ Giáº¥y PhÃ©p

Dá»± Ã¡n Ä‘Æ°á»£c cáº¥p phÃ©p theo [MIT License](LICENSE).

---

## â­ï¸ Náº¿u Tháº¥y Hay, HÃ£y á»¦ng Há»™ Dá»± Ãn!

```bash
â­ï¸ Star â€¢ ğŸ´ Fork â€¢ ğŸ Report Issue
```

---
```

================
File: requirements.txt
================
requests
python-dotenv
google-generativeai
tkinter
